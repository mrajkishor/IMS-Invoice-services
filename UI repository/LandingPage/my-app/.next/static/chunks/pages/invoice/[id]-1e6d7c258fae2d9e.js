(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[477],{14975:function(e,s,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/invoice/[id]",function(){return i(33460)}])},33460:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return j}});var n=i(85893),c=i(67294),l=i(11163),r=i(98690),a=i.n(r),o=i(91819),d=i(61120),t=i.n(d),h=i(21818),m=i(84059);i(1954),a().config.update({region:"ap-south-1",accessKeyId:"AKIAVKQ3NZATRAVRR7H3",secretAccessKey:"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"});let x=new(a()).DynamoDB.DocumentClient;function j(){let{id:e}=(0,l.useRouter)().query,[s,i]=(0,c.useState)(null),[r,a]=(0,c.useState)(1),d=(0,c.useCallback)(async e=>{try{let s=(await x.get({TableName:"Invoices",Key:{invoiceId:e}}).promise()).Item,n=await j(s.shopId),c=await u(s.userId);i({...s,shopName:n.shopName,shopAddress:n.shopAddress,userEmailorMobile:c.userEmailorMobile}),a(Number(s.templateId))}catch(e){console.error("Error fetching invoice data:",e)}},[]);(0,c.useEffect)(()=>{e&&d(e)},[e,d]);let j=async e=>{try{var s,i;let n=await x.get({TableName:"Shops",Key:{shopId:e}}).promise();return{shopName:(null==n?void 0:null===(s=n.Item)||void 0===s?void 0:s.shopName)||"Unknown Shop",shopAddress:(null==n?void 0:null===(i=n.Item)||void 0===i?void 0:i.address)||"Unknown Address"}}catch(e){return console.error("Error fetching shop data:",e),{shopName:"Unknown Shop",shopAddress:"Unknown Address"}}},u=async e=>{try{var s,i;let n=await x.get({TableName:"Customers",Key:{userId:e}}).promise();return console.log(n),{userEmailorMobile:(null==n?void 0:null===(s=n.Item)||void 0===s?void 0:s.email)||(null==n?void 0:null===(i=n.Item)||void 0===i?void 0:i.mobile)||"Unknown Contact"}}catch(e){return console.error("Error fetching customer data:",e),{userEmailorMobile:"Unknown Email"}}},p=async()=>{let s=document.getElementById("invoiceTemplate");if(s){let i=await t()(s),n=i.toDataURL("image/png"),c=new o.ZP("p","mm","a4"),l=210*i.height/i.width,r=l,a=0;for(c.addImage(n,"PNG",0,a,210,l),r-=295;r>=0;)a=r-l,c.addPage(),c.addImage(n,"PNG",0,a,210,l),r-=295;c.save("invoice_".concat(e,".pdf"))}};return(0,n.jsx)("main",{className:"invoice-main",children:(0,n.jsx)("div",{className:"invoice-container",children:s?(0,n.jsxs)(n.Fragment,{children:[(()=>{if(!s)return null;let e=window.location.href,i=new Date(s.invoiceDate),c=Math.ceil((new Date(s.dueDate).getTime()-i.getTime())/864e5);switch(r){case 1:return(0,n.jsxs)("div",{className:"template1",id:"invoiceTemplate",children:[(0,n.jsxs)("header",{className:"invoice-header",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"invoice-title",children:"Invoice"}),(0,n.jsxs)("p",{className:"invoice-id",children:["Invoice ID #",s.invoiceId]})]}),(0,n.jsxs)("div",{className:"invoice-company",children:[(0,n.jsx)("h2",{children:s.shopName}),"  ",(0,n.jsx)("p",{children:s.shopAddress}),"  ",(0,n.jsxs)("p",{children:["Contact : ",s.userEmailorMobile]}),"    "]})]}),(0,n.jsxs)("section",{className:"invoice-section",children:[(0,n.jsx)("h3",{children:"Billed To:"}),(0,n.jsx)("p",{children:s.customerName}),(0,n.jsx)("p",{children:s.customerAddress})]}),(0,n.jsxs)("section",{className:"invoice-section",children:[(0,n.jsx)("h3",{children:"Invoice Details:"}),(0,n.jsxs)("div",{className:"invoice-details",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Details:"})," ",s.details]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Amount:"})," Rs.",s.amount]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Invoice Date:"})," ",s.invoiceDate]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Due Date:"})," ",s.dueDate]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Status:"})," ",s.status]})]})]}),(0,n.jsxs)("section",{className:"invoice-section",children:[(0,n.jsx)("h3",{children:"QR Code:"}),(0,n.jsx)("div",{className:"invoice-qrcode",children:(0,n.jsx)(m.ZP,{value:e,size:128})})]}),(0,n.jsxs)("footer",{className:"invoice-footer",children:[(0,n.jsx)("p",{children:"Thank you for your business!"}),c>0&&(0,n.jsxs)("p",{children:["Payment is due within ",c," days"]}),(0,n.jsxs)("p",{children:["Please make checks payable to: ",s.shopName]})]})]});case 2:return(0,n.jsxs)("div",{className:"template-modern",id:"invoiceTemplate",children:[(0,n.jsxs)("header",{className:"invoice-header-modern",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"invoice-title-modern",children:"Invoice"}),(0,n.jsxs)("p",{className:"invoice-id-modern",children:["Invoice ID #",s.invoiceId]})]}),(0,n.jsxs)("div",{className:"invoice-company-modern",children:[(0,n.jsx)("h2",{children:s.shopName}),(0,n.jsx)("p",{children:s.shopAddress}),(0,n.jsxs)("p",{children:["Contact : ",s.userEmailorMobile]})]})]}),(0,n.jsxs)("section",{className:"invoice-section-modern",children:[(0,n.jsx)("h3",{children:"Billed To:"}),(0,n.jsx)("p",{children:s.customerName}),(0,n.jsx)("p",{children:s.customerAddress})]}),(0,n.jsxs)("section",{className:"invoice-section-modern",children:[(0,n.jsx)("h3",{children:"Invoice Details:"}),(0,n.jsxs)("div",{className:"invoice-details-modern",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Details:"})," ",s.details]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Amount:"})," Rs.",s.amount]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Invoice Date:"})," ",s.invoiceDate]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Due Date:"})," ",s.dueDate]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Status:"})," ",s.status]})]})]}),(0,n.jsxs)("section",{className:"invoice-section-modern",children:[(0,n.jsx)("h3",{children:"QR Code:"}),(0,n.jsx)("div",{className:"invoice-qrcode-modern",children:(0,n.jsx)(m.ZP,{value:e,size:128})})]}),(0,n.jsxs)("footer",{className:"invoice-footer-modern",children:[(0,n.jsx)("p",{children:"Thank you for your business!"}),c>0&&(0,n.jsxs)("p",{children:["Payment is due within ",c," days"]}),(0,n.jsxs)("p",{children:["Please make checks payable to: ",s.shopName]})]})]});case 3:return(0,n.jsxs)("div",{className:"template-stylish",id:"invoiceTemplate",children:[(0,n.jsxs)("header",{className:"invoice-header-stylish",children:[(0,n.jsxs)("div",{className:"header-left-stylish",children:[(0,n.jsx)("h1",{className:"invoice-title-stylish",children:"Invoice"}),(0,n.jsxs)("p",{className:"invoice-id-stylish",children:["Invoice ID #",s.invoiceId]})]}),(0,n.jsxs)("div",{className:"header-right-stylish",children:[(0,n.jsx)("h2",{children:s.shopName}),(0,n.jsx)("p",{children:s.shopAddress}),(0,n.jsxs)("p",{children:["Contact : ",s.userEmailorMobile]})]})]}),(0,n.jsxs)("section",{className:"invoice-section-stylish billed-to-stylish",children:[(0,n.jsx)("h3",{children:"Billed To:"}),(0,n.jsx)("p",{children:s.customerName}),(0,n.jsx)("p",{children:s.customerAddress})]}),(0,n.jsxs)("section",{className:"invoice-section-stylish invoice-details-stylish",children:[(0,n.jsx)("h3",{children:"Invoice Details:"}),(0,n.jsxs)("div",{className:"details-box-stylish",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Details:"})," ",s.details]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Amount:"})," Rs.",s.amount]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Invoice Date:"})," ",s.invoiceDate]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Due Date:"})," ",s.dueDate]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Status:"})," ",s.status]})]})]}),(0,n.jsxs)("section",{className:"invoice-section-stylish qr-code-stylish",children:[(0,n.jsx)("h3",{children:"Scan to View:"}),(0,n.jsx)(m.ZP,{value:e,size:128})]}),(0,n.jsxs)("footer",{className:"invoice-footer-stylish",children:[(0,n.jsx)("p",{className:"thank-you-stylish",children:"Thank you for your business!"}),c>0&&(0,n.jsxs)("p",{children:["Payment is due within ",c," days"]}),(0,n.jsxs)("p",{children:["Please make checks payable to: ",s.shopName]})]})]});case 4:return(0,n.jsxs)("div",{className:"template-premium",id:"invoiceTemplate",children:[(0,n.jsxs)("header",{className:"invoice-header-premium",children:[(0,n.jsxs)("div",{className:"header-left-premium",children:[(0,n.jsx)("h1",{className:"invoice-title-premium",children:"Invoice"}),(0,n.jsxs)("p",{className:"invoice-id-premium",children:["Invoice ID #",s.invoiceId]})]}),(0,n.jsxs)("div",{className:"header-right-premium",children:[(0,n.jsx)("h2",{children:s.shopName}),(0,n.jsx)("p",{children:s.shopAddress}),(0,n.jsxs)("p",{children:["Contact : ",s.userEmailorMobile]})]})]}),(0,n.jsxs)("section",{className:"invoice-section-premium billed-to-premium",children:[(0,n.jsx)("h3",{children:"Billed To:"}),(0,n.jsx)("p",{children:s.customerName}),(0,n.jsx)("p",{children:s.customerAddress})]}),(0,n.jsxs)("section",{className:"invoice-section-premium invoice-details-premium",children:[(0,n.jsx)("h3",{children:"Invoice Details:"}),(0,n.jsxs)("div",{className:"details-box-premium",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Details:"})," ",s.details]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Amount:"})," Rs.",s.amount]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Invoice Date:"})," ",s.invoiceDate]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Due Date:"})," ",s.dueDate]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Status:"})," ",s.status]})]})]}),(0,n.jsxs)("section",{className:"invoice-section-premium qr-code-premium",children:[(0,n.jsx)("h3",{children:"Scan to View:"}),(0,n.jsx)(m.ZP,{value:e,size:128})]}),(0,n.jsxs)("footer",{className:"invoice-footer-premium",children:[(0,n.jsx)("p",{className:"thank-you-premium",children:"Thank you for your business!"}),c>0&&(0,n.jsxs)("p",{children:["Payment is due within ",c," days"]}),(0,n.jsxs)("p",{children:["Please make checks payable to: ",s.shopName]})]})]});default:return(0,n.jsx)("div",{children:"Invalid Template"})}})(),(0,n.jsxs)("div",{className:"invoice-actions",children:[(0,n.jsx)("button",{onClick:p,className:"btn btn-download",children:"Download as PDF"}),(0,n.jsx)(h.N0,{url:window.location.href,title:"Check out this invoice #".concat(s.invoiceId),children:(0,n.jsx)("button",{className:"btn btn-share",children:"Share via WhatsApp"})})]})]}):(0,n.jsx)("p",{children:"Loading..."})})})}},1954:function(){},28022:function(){}},function(e){e.O(0,[586,847,443,880,888,774,179],function(){return e(e.s=14975)}),_N_E=e.O()}]);